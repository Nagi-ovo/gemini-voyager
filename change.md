# Changelog

### Chrome 开发流程优化 - 2026-01-19
#### 修改内容：
- 新增文件：`scripts/launch-chrome-dev.js`
- 修改文件：`package.json` (新增 `dev:chrome-open` 命令)
- 修改文件：`.gitignore` (添加 `.chrome-dev-data/`)

#### 变更逻辑：
新增 `bun run dev:chrome-open` 命令，实现一键启动 Chrome 开发环境：
1. 自动检测系统 Chrome 路径
2. 清理使用相同 user-data-dir 的残留 Chrome 进程
3. 启动 Vite 编译（通过 nodemon 监听文件变化）
4. 编译完成后自动启动 Chrome，使用隔离的用户数据目录
5. 自动打开 Gemini 主页

首次运行时需要手动在 chrome://extensions 开启开发者模式并加载扩展，后续运行会自动记住设置。

### [批量删除 Gemini 聊天记录] - 日期: 2026-01-19
#### 修改内容：
- 修改文件：`src/pages/content/folder/manager.ts`
- 修改位置：第 94-98 行（新增属性），第 2152-2165 行（数量限制），第 2320-2350 行（UI 按钮），第 2140-2490 行（批量删除核心方法）
- 变更逻辑：实现在 Gemini 原生侧边栏批量选择并删除聊天记录的功能

- 新增文件修改：`src/locales/en/messages.json`
- 修改位置：第 825-850 行
- 变更逻辑：添加 6 个批量删除相关的英文国际化文案

- 新增文件修改：`src/locales/zh/messages.json`
- 修改位置：第 833-858 行
- 变更逻辑：添加 6 个批量删除相关的中文国际化文案

#### 功能说明：
1. **多选模式**：在 Gemini 侧边栏长按会话可进入多选模式
2. **数量限制**：一次最多选择 50 个会话
3. **批量删除**：点击删除按钮后，扩展会串行模拟点击每个会话的原生删除操作
4. **进度反馈**：显示删除进度（正在删除... 1/10）
5. **结果汇总**：删除完成后显示成功/失败数量
6. **页面刷新**：删除完成后自动刷新页面

#### 技术实现：
- 通过模拟用户点击触发 Gemini 原生删除按钮
- 每次删除间隔 500ms，避免触发速率限制
- 支持自动确认删除对话框

### [修复批量删除确认对话框] - 日期: 2026-01-19
#### 修改内容：
- 修改文件：`src/pages/content/folder/manager.ts`
- 修改位置：第 2353-2397 行（`confirmDeleteIfNeeded` 方法）
- 变更逻辑：增强确认对话框按钮检测

#### 改进内容：
1. **多策略按钮匹配**：新增 4 种策略匹配确认按钮
   - 按 `data-test-id` 属性匹配
   - 按 Material 主题按钮类匹配
   - 按按钮文本匹配（支持中英文）
   - 按对话框按钮位置匹配（最后一个按钮通常是确认）
2. **可见性检查**：新增 `isVisibleElement` 方法，只点击可见的按钮
3. **中文支持**：支持"删除"、"确认"、"确定"等中文按钮文本


### [修复批量删除国际化匹配问题] - 日期: 2026-01-20
#### 修改内容：
- 修改文件：`src/locales/en/messages.json`
- 修改位置：第 851 行左右
- 变更逻辑：在英文语言包的 `batch_delete_match_patterns` 中添加中文关键词（"删除", "确认", "确定", "是"）。

#### 原因与影响：
- **原因**：当浏览器/扩展语言为英文但 Gemini 页面为中文时，批量删除功能无法识别中文的“删除”按钮，导致无法自动点击。
- **影响**：修复了在跨语言环境下无法触发原生删除操作的问题，提高了功能的鲁棒性。
